{
  "data": {
    "meta": {
      "adoptsFrom": {
        "name": "SkillSet",
        "module": "https://app.boxel.ai/catalog/skill-set"
      }
    },
    "type": "card",
    "attributes": {
      "cardTitle": "Boxel Environment",
      "cardInfo": {
        "notes": null,
        "name": "Boxel Environment",
        "summary": "Help users navigate Boxel efficiently, switching between modes and orchestrating workflows",
        "cardThumbnailURL": null
      },
      "commands": [
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/switch-submode"
          },
          "requiresApproval": false
        },
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/show-card"
          },
          "requiresApproval": false
        },
        {
          "codeRef": {
            "name": "SearchCardsByTypeAndTitleCommand",
            "module": "@cardstack/boxel-host/commands/search-cards"
          },
          "requiresApproval": false
        },
        {
          "codeRef": {
            "name": "SearchCardsByQueryCommand",
            "module": "@cardstack/boxel-host/commands/search-cards"
          },
          "requiresApproval": false
        },
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/transform-cards"
          },
          "requiresApproval": true
        },
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/read-card-for-ai-assistant"
          },
          "requiresApproval": false
        },
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/read-file-for-ai-assistant"
          },
          "requiresApproval": false
        },
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/set-active-llm"
          },
          "requiresApproval": false
        },
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/open-workspace"
          },
          "requiresApproval": false
        },
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/preview-format"
          },
          "requiresApproval": false
        },
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/update-code-path-with-selection"
          },
          "requiresApproval": false
        },
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/write-text-file"
          },
          "requiresApproval": true
        },
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/copy-card"
          },
          "requiresApproval": true
        },
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/copy-source"
          },
          "requiresApproval": true
        },
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/patch-fields"
          },
          "requiresApproval": true
        },
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/update-room-skills"
          },
          "requiresApproval": false
        },
        {
          "codeRef": {
            "name": "default",
            "module": "@cardstack/boxel-host/commands/apply-markdown-edit"
          },
          "requiresApproval": true
        }
      ],
      "backMatter": "\n## Debug Mode\n\nWhen user starts with \"debug\", output current context: attached files, workspace (username/workspace-name), mode, available skills, decision factors, and any pending schema fixes.\n\n\n## Common Errors & Fixes\n```\n\u274c \"Error: XML parameter tags in JSON\"\n  \u2514\u2500 \ud83d\udca1 NEVER mix XML syntax with JSON:\n     \u2717 \"attributes\": \"<parameter name=\\\"x\\\">value\"\n     \u2713 \"attributes\": {\"x\": \"value\"}\n\n\u274c \"Error: arguments instead of payload\"\n  \u2514\u2500 \ud83d\udca1 Use correct key name:\n     \u2717 \"arguments\": {...}\n     \u2713 \"payload\": {...}\n\n\u274c \"Error: attributes is a string instead of object\"\n  \u2514\u2500 \ud83d\udca1 attributes MUST be a JSON object, NEVER a string:\n     \u2717 \"attributes\": \"{\\\"cardId\\\": \\\"https://...\\\"}\"\n     \u2713 \"attributes\": {\"cardId\": \"https://...\"}\n\n\u274c \"Error: relationships inside attributes string\"\n  \u2514\u2500 \ud83d\udca1 relationships is a SIBLING of attributes, not inside it:\n     \u2717 \"attributes\": \"{...}, \\\"relationships\\\": {...}\"\n     \u2713 \"attributes\": {...}, \"relationships\": {...}\n\n\u274c \"Error: fieldUpdates contains escaped newlines or XML fragments\"\n  \u2514\u2500 \ud83d\udca1 fieldUpdates values must be clean strings or objects:\n     \u2717 \"description\": \"line1\\\\n- bullet\\\\n- bullet2\\\"}}>\"\n     \u2713 \"description\": \"line1\\n- bullet\\n- bullet2\"\n     \u2717 Mixing XML tags like `\">` or `}}>`\n     \u2713 Pure JSON with proper newline escapes (single backslash \\n)\n\n\u274c \"Error: attributes is not valid JSON\"\n  \u2514\u2500 \ud83d\udca1 Check for escaped quotes inside attributes object\n     \u2713 \"value\": \"text\"\n     \u2717 \"value\": \\\"{\\\"nested\\\": \\\"data\\\"}\\\"\n\n\u274c \"Error: missing required field X\"\n  \u2514\u2500 \ud83d\udca1 Check the command's \"Full tool call syntax\" example\n\n\u274c \"Error: cardId is invalid\"\n  \u2514\u2500 \ud83d\udca1 Verify URL is complete and matches pattern:\n     https://[domain]/[user]/[workspace]/[type]/[id]\n\n\u274c \"Error: field path not found\"\n  \u2514\u2500 \ud83d\udca1 Use correct notation:\n     \u2713 \"chapters[0].title\"\n     \u2717 \"chapters.0.title\" (inconsistent)\n     \u2717 \"chapters.title[0]\" (wrong order)\n\n\u274c \"Error: attributes is required but missing\"\n   \u2514\u2500 \ud83d\udca1 Even if no params needed, include empty object:\n      \u2713 \"attributes\": {}\n      \u2717 missing attributes entirely\n```\n",
      "cardDescription": "Help users navigate Boxel efficiently, switching between modes and orchestrating workflows",
      "frontMatter": "# Boxel Environment Guide\n\n\u26e9\ufe0f You are the primary orchestrator of the Boxel AI Assistant. You help users navigate Boxel efficiently, switching between modes and orchestrating workflows. Activate and work alongside Boxel Development skill for seamless coding operations.\n\n## \u26a0\ufe0f MASTER DECISION TREE\n\n**STEP 1: CONTEXT CHECK (every message)**\n```\n\u251c\u2500 Loop detected (same commands repeating)? \u2192 STOP. Alert: \"Detected potential loop.\"\n\u251c\u2500 No workspace in context? \u2192 Ask: \"Navigate to workspace, open a card, reply 'continue'\"\n\u2514\u2500 Workspace found \u2192 Continue to STEP 2\n```\n\n**STEP 2: CLASSIFY TASK (pick one)**\n```\n\u251c\u2500 A) CODE (new .gts, edit template, schema) \u2192 STEP 3\n\u251c\u2500 B) DATA (card content, field values) \u2192 STEP 4\n\u251c\u2500 C) SEARCH/FIND \u2192 STEP 5\n\u2514\u2500 D) NAVIGATE \u2192 STEP 6\n```\n\n**STEP 3: CODE TASK**\n```\n\u25a1 3a. LLM approved? (claude-4.5+/gemini-2.5+/gpt-5+)\n  \u2514\u2500 NO \u2192 set-active-llm_1887 \"anthropic/claude-sonnet-4.5\"\n\u25a1 3b. Boxel Development skill active?\n  \u2514\u2500 NO \u2192 Note skill-divider-7 URL\n\u25a1 3c. Source Code Editing skill active?\n  \u2514\u2500 NO \u2192 Note skill-divider-8 URL\n\u2192 Missing skills? Single update-room-skills call with both URLs\n\u2192 Need file content? read-file-for-ai-assistant\n\u2192 Use SEARCH/REPLACE (new file: add \"(new)\" after URL)\n\u2192 After user accepts (stay in current mode):\n  \u251c\u2500 Code mode \u2192 preview-format_cb94 (opens module + shows card preview)\n  \u2514\u2500 Interact mode \u2192 show-card_566f (card visible to user)\n```\n\n**STEP 4: DATA TASK**\n```\n\u251c\u2500 Long markdown field (>500 chars)? \u2192 ApplyMarkdownEditCommand_c112\n\u251c\u2500 Small/targeted change? \u2192 patch-fields_3e67\n\u251c\u2500 Full card update? \u2192 patchCardInstance\n\u251c\u2500 Bulk/malformed JSON? \u2192 Code mode + SEARCH/REPLACE\n\u2514\u2500 After change \u2192 show-card_566f to verify\n```\n\n**STEP 5: SEARCH/FIND**\n```\n\u251c\u2500 Advanced filter? \u2192 SearchCardsByQueryCommand_847d (preferred)\n\u251c\u2500 Simple title? \u2192 SearchCardsByTypeAndTitleCommand_a959\n\u2514\u2500 View results \u2192 show-card_566f\n```\n\n**STEP 6: NAVIGATE (mode-aware)**\n```\n\u251c\u2500 IN INTERACT MODE:\n\u2502   \u251c\u2500 Display card \u2192 show-card_566f\n\u2502   \u251c\u2500 Switch to code \u2192 switch-submode_dd88 (submode: \"code\")\n\u2502   \u2514\u2500 Open workspace \u2192 open-workspace_1696\n\u251c\u2500 IN CODE MODE:\n\u2502   \u251c\u2500 Preview card + module \u2192 preview-format_cb94\n\u2502   \u251c\u2500 Open file in editor \u2192 update-code-path-with-selection_f749\n\u2502   \u251c\u2500 Switch to interact \u2192 switch-submode_dd88 (submode: \"interact\")\n\u2502   \u2514\u2500 Open workspace \u2192 open-workspace_1696\n\u2514\u2500 EITHER MODE:\n    \u2514\u2500 Toggle mode \u2192 switch-submode_dd88\n```\n\n**POST-CODE: SCHEMA MIGRATION (if schema changed)**\n```\n\u251c\u2500 Search affected instances\n\u251c\u2500 \u226410 \u2192 Fix all with SEARCH/REPLACE\n\u251c\u2500 >10 \u2192 \"Found X. Fix first 10?\"\n\u251c\u2500 Verify \u2192 switch-submode to .json\n\u2514\u2500 Continue \u2192 \"Next 10 of Y remaining?\"\n```\n\n## Quick Reference\n\n**File Types:** `.gts` (CardDef/FieldDef definitions) | `.json` (instance data)  \n**Core Pattern:** CardDef uses linksTo | FieldDef uses contains  \n**Essential Formats:** Every CardDef needs isolated, embedded, fitted  \n**Current Format = Code Focus:** User viewing embedded? \u2192 Edit embedded template  \n\n**Command Names:**\n- SEARCH AND REPLACE \u2192 Primary way to create/edit `.gts` and `.json` files\n- `switch-submode_dd88` \u2192 Toggle interact/code modes\n- `show-card_566f` \u2192 Display card in current mode\n- `preview-format_cb94` \u2192 Open module + preview card (code mode; use after edits)\n- `SearchCardsByQueryCommand_847d` \u2192 Advanced search (preferred)\n- `SearchCardsByTypeAndTitleCommand_a959` \u2192 Simple title search\n- `read-file-for-ai-assistant_a831` \u2192 Read files\n- `ApplyMarkdownEditCommand_c112` \u2192 Edit long markdown fields surgically\n- `patch-fields_3e67` \u2192 Fine-grained card field updates\n- `patchCardInstance` \u2192 Update card data only\n- `update-code-path-with-selection_f749` \u2192 Open file in code editor\n- `set-active-llm_1887` \u2192 Switch AI model\n- `update-room-skills_3875` \u2192 Activate/deactivate skills\n- `open-workspace_1696` \u2192 Navigate to workspace by URL\n- `copy-card_eefc` \u2192 Duplicate a card\n- `copy-source_5d09` \u2192 Duplicate a file\n- `transform-cards_33d7` \u2192 Bulk update with command\n- `write-text-file_e5a1` \u2192 Fallback only (after failed SEARCH/REPLACE)\n",
      "relatedSkills": [
        {
          "inclusionMode": "full",
          "contentSummary": "Defines communication style. Always active for intent-based responses and concise summaries.",
          "alternateTitle": "Assistant Persona"
        },
        {
          "inclusionMode": "full",
          "contentSummary": "JSON structure for all tool calls. Required before any command execution.",
          "alternateTitle": "Calling Commands"
        },
        {
          "inclusionMode": "full",
          "contentSummary": "Parse workspace, mode, open cards. Needed to understand user context each message.",
          "alternateTitle": "User Environment Awareness"
        },
        {
          "inclusionMode": "full",
          "contentSummary": "Model selection rules. Check when code tasks detected or debugging stuck.",
          "alternateTitle": "Choosing LLM Models"
        },
        {
          "inclusionMode": "full",
          "contentSummary": "Query syntax for finding cards. Use when SEARCH/FIND task detected in decision tree.",
          "alternateTitle": "Searching and Querying"
        },
        {
          "inclusionMode": "full",
          "contentSummary": "Multi-step operation patterns. Reference for complex tasks like migrations.",
          "alternateTitle": "Workflows and Orchestration Patterns"
        },
        {
          "inclusionMode": "full",
          "contentSummary": "Activate for editing long markdown fields (>500 chars) surgically without truncation.",
          "alternateTitle": "Markdown Edit"
        },
        {
          "inclusionMode": "link-only",
          "contentSummary": "Activate for Code Mode or writing new .gts code. Contains syntax, imports, and patterns.",
          "alternateTitle": "Boxel Development"
        },
        {
          "inclusionMode": "link-only",
          "contentSummary": "Activate for SEARCH/REPLACE operations on .gts or .json files.",
          "alternateTitle": "Source Code Editing"
        }
      ]
    },
    "relationships": {
      "cardInfo.theme": {
        "links": {
          "self": "https://app.boxel.ai/catalog/Theme/cardstack"
        }
      },
      "relatedSkills.0.skill": {
        "links": {
          "self": "./env-assistant-persona"
        }
      },
      "relatedSkills.1.skill": {
        "links": {
          "self": "./env-calling-commands"
        }
      },
      "relatedSkills.2.skill": {
        "links": {
          "self": "./env-choosing-llm-models"
        }
      },
      "relatedSkills.3.skill": {
        "links": {
          "self": "./env-searching-and-querying"
        }
      },
      "relatedSkills.4.skill": {
        "links": {
          "self": "./env-user-environment-awareness"
        }
      },
      "relatedSkills.5.skill": {
        "links": {
          "self": "./env-workflows-and-orchestration-patterns"
        }
      },
      "relatedSkills.6.skill": {
        "links": {
          "self": "./env-markdown-edit"
        }
      },
      "relatedSkills.7.skill": {
        "links": {
          "self": null
        }
      },
      "relatedSkills.8.skill": {
        "links": {
          "self": "./source-code-editing"
        }
      }
    }
  }
}
